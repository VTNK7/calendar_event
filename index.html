<!DOCTYPE html>
<html>
<head>
    <title>Invitation Calendrier</title>
</head>
<body>
    <h1 id="title">Chargement...</h1>
    <button id="btn">Ajouter à mon calendrier</button>

    <script>
document.getElementById('btn').onclick = function() {
    const icsContent = `BEGIN:VCALENDAR
VERSION:2.0
BEGIN:VEVENT
SUMMARY:${titre}
DTSTART:${date}
DTEND:${date}
END:VEVENT
END:VCALENDAR`;

    // 1. On encode le contenu en Base64 pour Safari
    const base64Content = btoa(unescape(encodeURIComponent(icsContent)));
    const dataUri = 'data:text/calendar;base64,' + base64Content;

    // 2. On crée un lien temporaire
    const link = document.createElement('a');
    link.href = dataUri;
    link.download = "evenement.ics";
    
    // 3. IMPORTANT pour Safari : ajouter le lien au document avant de cliquer
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
};
    </script>
</body>
</html>
